<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:MauiApp1.ViewModels"
             xmlns:dtos="clr-namespace:MauiApp1.AppLogic.DTOs"
             xmlns:controls="clr-namespace:MauiApp1.Controls"
             x:Class="MauiApp1.MainPage"
             x:DataType="viewmodels:MainPageViewModel"
             Title="Main Page">
    <Grid>
        <RefreshView>
            <VerticalStackLayout Spacing="15">

                <CarouselView x:Name="MainBanner"
                              ItemsSource="{Binding Banners}"
                              HeightRequest="200"
                              IndicatorView="indicator"
                              Loop="True">
                    <CarouselView.ItemTemplate>
                        <DataTemplate x:DataType="dtos:BannerDto">
                            <Border StrokeShape="RoundRectangle 15" 
                                    Margin="20,10"
                                    StrokeThickness="0">
                                <Grid>
                                    <Image Source="{Binding ImageUrl}" 
                                           Aspect="AspectFill" 
                                           HorizontalOptions="Fill" 
                                           VerticalOptions="Fill"/>

                                    <BoxView Color="Black" Opacity="0.3" 
                                             VerticalOptions="End" HeightRequest="50"/>

                                    <Label Text="{Binding Title}" 
                                           TextColor="{StaticResource White}"
                                           FontSize="18"
                                           FontAttributes="Bold"
                                           VerticalOptions="End"
                                           Padding="15,10"/>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </CarouselView.ItemTemplate>
                </CarouselView>

                <IndicatorView x:Name="indicator"
                               IndicatorColor="{StaticResource Gray300}"
                               SelectedIndicatorColor="{StaticResource Primary}"
                               HorizontalOptions="Center" 
                               Margin="0,0,0,10"/>
                <Button Text="User Management"
                        Command="{Binding GoToUserManagePageCommand}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="{StaticResource White}"
                        FontSize="18"
                        HeightRequest="50"
                        CornerRadius="10"
                        Margin="20,0" />

                <Button Text="Product Management"
                        Command="{Binding GoToProductManagePageCommand}"
                        BackgroundColor="{StaticResource Primary}"
                        TextColor="{StaticResource White}"
                        FontSize="18"
                        HeightRequest="50"
                        CornerRadius="10"
                        Margin="20,0" />

                <BoxView HeightRequest="1" Color="LightGray" Margin="20,10" />
                <Label Text="System Connection Test" 
                       FontSize="16" FontAttributes="Bold" Margin="20,0"/>

                <Button Text="PING GRPC SERVER"
                        Clicked="OnTestGrpcClicked"
                        BackgroundColor="Orange" 
                        TextColor="White"
                        HeightRequest="45"
                        CornerRadius="10"
                        Margin="20,5" />

                <Label x:Name="GrpcStatusLabel"
                       Text="Status: Ready to test"
                       FontSize="14"
                       TextColor="Gray"
                       HorizontalOptions="Center"
                       Margin="0,0,0,20"/>
                
            </VerticalStackLayout>
        </RefreshView>

        <controls:ToastNotification x:Name="LoginToast" VerticalOptions="Start" />

    </Grid>
</ContentPage>